---
title: 进程和线程
date: 2018-05-10 14:28:44
tags: 
categories: 系统学习

---

首先给出本节的主要内容！

1.进程：进程的概念、进程控制块、进程状态、三状态进程模型、挂起进程模型

2.线程：为什么引入线程、线程的概念、用户线程、内核线程
<!--more-->
## 1.进程的概念

1.进程的概念
![](https://i.imgur.com/1fuIZnq.jpg)

2.进程的特点

动态性：可动态的创建、结束进程

并发性：进程可以被独立调度并占用处理机（交替执行）

独立性：不同的进程工作互不影响

制约性：因访问共享数据或者资源或者进程间同步而产生制约

3.进程与程序的联系

![](https://i.imgur.com/JkgQ7dd.jpg)

4.进程和程序的区别

![](https://i.imgur.com/zPY8axA.jpg)

## 2.进程控制块

在这里我指向强调两点

1.进程控制块中的内容

![](https://i.imgur.com/XO9Gayf.jpg)

2.进程控制块的组织形式

![](https://i.imgur.com/lyMe0Jt.jpg)

## 3.进程的状态

![](https://i.imgur.com/z2mg4HL.jpg)

下面我针对每个状态详细阐述一下
 
1.创建：引起进程创建的情况：

系统初始化的时候；用户请求创建一个新进程；正在运行的进程执行了创建进程的系统调用（fork和do_fork）

2.当一个进程创建好以后就进入了就绪队列，这个时候内核根据系统调用算法，选择合适的进程进入运行状态。

3.等待：进程进入等待（阻塞）的情况：

请求并等待系统服务，无法马上完成；启动某种操作的，无法马上完成（读写磁盘的速度）；需要的数据没有到达

注意：只有进程自身才会导致进程进入等待状态，不会被外部改变

4.运行-->就绪：

高优先级进程就绪；

进程当前的时间片用完；

5.等待-->就绪:（唤醒）

唤醒进程的情况，被阻塞的进程需要的资源可被满足；被阻塞的进程等待的时间的到达；

注意：唤醒只能被其他进程或者操作系统唤醒

6.运行-->退出

进程结束的情况：

正常退出（自愿的）、错误退出（自愿的）、致命错误（强制性的）、被其他进程所杀死（强制性的）

下面阐述一下sleep()系统调用对应的进程状态变化

创建-->就绪-->运行-->等待-->就绪-->运行-->结束。

## 4.三状态进程模型（就绪，运行，等待）

运行：进程正在CPU上运行

就绪：进程获得了除处理机以外的所需资源，只需要得到处理机就可以运行

等待(阻塞)：进程等待某事件的出现而暂停的状态

除了这三个状态以外还有两个辅助状态

1.创建状态：一个进程正在被创建，还没被转到就绪状态之前的状态，正在分配资源

2.退出状态：进程正在从操作系统中退出，清理所占资源 

## 5.挂起进程模型

之前讨论的状态都是和CPU有关系的状态。但实际上进程的状态中还有一类和存储相关，一部分存储在外存和虚拟存储关联，这就是牵扯到挂起状态。

![](https://i.imgur.com/FbfATIV.jpg)

这是进程挂起的一个状态模型图，可以看出里面和之前相比，多了等待挂起、就绪挂起这两种状态，新加的这两种状态是为了描述进程在外存中的状态。

1.等待挂起：进程在外存并等待某事件的出现（相当于在等待的基础上加了进程的位置的信息）

2.就绪挂起：进程在外存，但是只要进入内存，即可运行。

挂起：把一个进程从内存转到外存。

下面我来阐述一下内存到外存的转变(挂起)：

1.等待-->等待挂起:

没有进程处于就绪状态或者就绪进程要求更多内存资源。

2.就绪-->就绪挂起 

当有高优先级等待（系统认为很快就会就绪的）进程和低优先级就绪进程，为了让高优先级有足够的就绪空间，低优先级就绪进程就变成挂起就绪

3.运行-->就绪挂起

对抢占时分时系统，当有高等优先级进程进入就绪要运行，但是没有足够的内存空间，那么正在运行的低优先级变成挂起就绪状态

上面是内存-->外存状态的切换

下面介绍一下在外存中的状态转换

1.等待挂起-->就绪挂起

当有等待挂起进程因相关事件出现

下面在说一下从外存到内存的状态转换（激活：把一个进程从外存转到内存）

1.就绪挂起-->就绪

没有就绪进程或挂起就绪进程优先级高于就绪进程

2.等待挂起-->等待

当一个进程释放足够的内存，并且有高优先级等带挂起进程。

到这里关于状态装换就说完了。。。

---------------------------------------------------------

下面来讨论线程部分

## 线程

线程的提出原因：多个进程之间切换调度耗费资源，进程间通信困难，效率低下，所以需要多线程。可以在 进程内实现并发执行，并且共享实体之间的地址空间。

## 线程的概念 ：

线程是进程的一部分，描述指令执行流的状态，他是进程中指令执行的最小单元，是CPU调度的基本单位。将进程的执行流分离出来，为并发提供更好的可能

![](https://i.imgur.com/ioFGo9h.jpg)

![](https://i.imgur.com/XsS8Th5.jpg)

![](https://i.imgur.com/UnyqI6i.jpg)

‘  















